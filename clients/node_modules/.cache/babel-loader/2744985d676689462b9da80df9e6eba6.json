{"ast":null,"code":"import { deleteComment, PatchComment } from \"../api/CommentsApi\";\nimport { createCommentsOnPost, createlike, deletelike, getCommentsOnPost, getLikesFromPost, getPost, PostByid, PostDelete } from \"../api/PostApi\";\nexport const getPosts = () => async dispatch => {\n  try {\n    const {\n      data\n    } = await getPost;\n    return dispatch({\n      type: 'getposts',\n      payload: data\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const GetLikes = id => async dispatch => {\n  try {\n    const {\n      data\n    } = await getLikesFromPost(id);\n    return dispatch({\n      type: 'getlikes',\n      payload: data.result\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const getPostById = id => async dispatch => {\n  try {\n    const {\n      data\n    } = await PostByid(id);\n    return dispatch({\n      type: \"getpostbyid\",\n      payload: data.result\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const getComments = id => async dispatch => {\n  try {\n    const {\n      data\n    } = await getCommentsOnPost(id);\n    return dispatch({\n      type: 'getCommentsOnPost',\n      payload: data.result\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const createComment = (id, comment) => async dispatch => {\n  try {\n    const {\n      data\n    } = await createCommentsOnPost(id, comment);\n    console.log(data);\n    let comments; //vse kommentu\n\n    if (data.result.affectedRows > 0) {\n      const Data = await getCommentsOnPost(id);\n      return dispatch({\n        type: 'createcommentforpost',\n        payload: Data.data.result\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const likePost = id => async dispatch => {\n  try {\n    const {\n      data\n    } = await createlike(id);\n    const Data = await getLikesFromPost(id);\n    let likes;\n\n    if (data.result.affectedRows > 0) {\n      likes = Data.data.result;\n      let like = likes[likes.length - 1];\n      dispatch({\n        type: \"likepost\",\n        payload: like\n      });\n    }\n  } catch (error) {\n    alert('You already paste like');\n  }\n};\nexport const DeletComment = (id, post_id) => async dispatch => {\n  try {\n    const {\n      data\n    } = await deleteComment(id);\n\n    if (data.result.affectedRows > 0) {\n      const Data = await getCommentsOnPost(post_id);\n      return dispatch({\n        type: 'deletecomment',\n        payload: Data.data.result\n      });\n    }\n  } catch (error) {\n    alert(\"It`s not your comment\");\n  }\n};\nexport const deletePost = id => async dispatch => {\n  try {\n    const {\n      data\n    } = await PostDelete(id);\n\n    if (data.message.affectedRows > 0) {\n      const Data = await getPost;\n      const allPost = Data.data;\n      let i;\n\n      for (let index = 0; index < allPost.length; index++) {\n        if (allPost[index].id === id) {\n          i = index;\n        }\n      }\n\n      if (i > -1) {\n        allPost.splice(i, 1);\n      }\n\n      console.log(allPost);\n      return dispatch({\n        type: 'deletepost',\n        payload: allPost\n      });\n    }\n  } catch (error) {}\n};\nexport const UpdateComment = (id, post_id, content) => async dispatch => {\n  try {\n    const {\n      data\n    } = await PatchComment(id, content);\n\n    if (data.result.affectedRows > 0) {\n      const Data = await getCommentsOnPost(post_id);\n      return dispatch({\n        type: 'updatecomment',\n        payload: Data.data.result\n      });\n    }\n  } catch (error) {\n    alert(\"It`s not your comment\");\n  }\n};\nexport const deleteLikeFromPost = id => async dispatch => {\n  try {\n    const {\n      data\n    } = await deletelike(id);\n    const Data = await getLikesFromPost(id);\n\n    if (data.result.affectedRows > 0) {\n      let likes = Data.data.result;\n      let like = [];\n\n      for (let index = 0; index < likes.length; index++) {\n        if (data.user === likes[index].user_id) {\n          index = index + 1;\n        }\n\n        like[index] = likes[index];\n      }\n\n      dispatch({\n        type: 'deletelike',\n        payload: like\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  }\n};","map":{"version":3,"names":["deleteComment","PatchComment","createCommentsOnPost","createlike","deletelike","getCommentsOnPost","getLikesFromPost","getPost","PostByid","PostDelete","getPosts","dispatch","data","type","payload","error","console","log","GetLikes","id","result","getPostById","getComments","createComment","comment","comments","affectedRows","Data","likePost","likes","like","length","alert","DeletComment","post_id","deletePost","message","allPost","i","index","splice","UpdateComment","content","deleteLikeFromPost","user","user_id"],"sources":["/home/firemort/Рабочий стол/Fullstack/back-front/idashchenk/clients/src/action/PostAction.js"],"sourcesContent":["import { deleteComment, PatchComment } from \"../api/CommentsApi\";\nimport { createCommentsOnPost, createlike, deletelike, getCommentsOnPost, getLikesFromPost, getPost, PostByid, PostDelete } from \"../api/PostApi\"\n\n\nexport const getPosts = () => async(dispatch) => {\n    try {\n        const {data}= await getPost\n        return dispatch({type:'getposts', payload:data})\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nexport const GetLikes = (id) => async(dispatch) => {\n    try {\n        const {data} = await getLikesFromPost(id)\n        return dispatch({type:'getlikes', payload:data.result})\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nexport const getPostById = (id) => async(dispatch) => {\n    try {\n        const {data} = await PostByid(id)\n        return dispatch({type:\"getpostbyid\", payload:data.result})\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nexport const getComments = (id) => async(dispatch) => {\n    try {\n        const {data} = await getCommentsOnPost(id)\n        return dispatch({type:'getCommentsOnPost', payload:data.result})\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nexport const createComment = (id, comment) => async(dispatch) => {\n    try {\n        const {data} = await createCommentsOnPost(id,comment)\n        console.log(data);\n        let comments //vse kommentu\n        if (data.result.affectedRows > 0) {\n            const Data = await getCommentsOnPost(id)\n            return dispatch({type:'createcommentforpost', payload:Data.data.result})\n        }\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nexport const likePost = (id) => async(dispatch) => {\n    try {\n        const {data} = await createlike(id)\n        const Data = await getLikesFromPost(id)\n        let likes\n        if (data.result.affectedRows > 0) {\n            likes = Data.data.result\n            let like = likes[likes.length-1]\n            dispatch({type:\"likepost\", payload:like})\n        }\n    } catch (error) {\n        alert('You already paste like')\n    }\n}\n\nexport const DeletComment = (id,post_id) => async(dispatch) => {\n    try {\n        const {data} = await deleteComment(id)\n        if (data.result.affectedRows > 0) {\n            const Data = await getCommentsOnPost(post_id)\n            return dispatch({type:'deletecomment',payload:Data.data.result})\n        }   \n    } catch (error) {\n        alert(\"It`s not your comment\")\n    }\n}\n\nexport const deletePost = (id) => async(dispatch) => {\n    try {\n        const {data} = await PostDelete(id) \n        if (data.message.affectedRows > 0) {\n            const Data = await getPost\n            const allPost = Data.data\n            let i\n            for (let index = 0; index < allPost.length; index++) {\n                if (allPost[index].id === id) {\n                    i = index\n                }\n            }\n            if (i > -1) {\n                allPost.splice(i,1)\n            }\n            console.log(allPost);\n            return dispatch({type:'deletepost', payload:allPost})\n        }\n    } catch (error) {\n        \n    }\n}\n\nexport const UpdateComment = (id,post_id,content) => async(dispatch) => {\n    try {\n        const {data} = await PatchComment(id,content)\n        if (data.result.affectedRows > 0) {\n            const Data = await getCommentsOnPost(post_id)\n            return dispatch({type:'updatecomment', payload:Data.data.result})\n        }\n    } catch (error) {\n        alert(\"It`s not your comment\")\n    }\n}\n\nexport const deleteLikeFromPost = (id) => async(dispatch) => {\n    try {\n        const {data} = await deletelike(id)\n        const Data = await getLikesFromPost(id)\n        if (data.result.affectedRows>0) {\n            let likes = Data.data.result\n            let like = []\n            for (let index = 0; index < likes.length; index++) {\n                if (data.user === likes[index].user_id) {\n                    index = index+1\n                }\n                like[index] = likes[index]\n            }\n            dispatch({type:'deletelike', payload:like})\n        }\n    } catch (error) {\n        console.log(error);\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}